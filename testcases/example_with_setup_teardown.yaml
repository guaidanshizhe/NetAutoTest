test_case:
  id: TC_SETUP_001
  name: 带Setup和Teardown的测试示例
  category: 示例
  description: 演示如何使用setup和teardown进行测试前后处理
  
  # 前置步骤：测试开始前执行
  setup:
    - action: 记录检查项
      params:
        item_name: 测试环境准备
        status: success
        details: 开始准备测试环境
    
    - action: 执行Shell命令
      params:
        server: server1
        command: "mkdir -p /tmp/test_workspace"
    
    - action: 写入文件
      params:
        server: server1
        file_path: /tmp/test_workspace/test_flag
        content: "test_started"
    
    - action: 记录检查项
      params:
        item_name: 测试环境准备完成
        status: success
        details: 工作目录和标志文件已创建
  
  # 主要测试步骤
  steps:
    - action: 检查文件存在
      params:
        server: server1
        file_path: /tmp/test_workspace/test_flag
    
    - action: 验证为真
      params:
        actual: ${last_result}
        message: 测试标志文件应该存在
    
    - action: 读取文件
      params:
        server: server1
        file_path: /tmp/test_workspace/test_flag
    
    - action: 验证包含
      params:
        actual: ${last_result}
        expected: "test_started"
        message: 文件内容应该包含测试标志
    
    - action: 获取CPU使用率
      params:
        server: server1
    
    - action: 记录检查项
      params:
        item_name: 系统资源检查
        status: success
        details: CPU使用率 ${last_result}%
  
  # 后置步骤：测试结束后执行（无论成功失败）
  teardown:
    - action: 记录检查项
      params:
        item_name: 开始清理测试环境
        status: success
        details: 清理临时文件和目录
    
    - action: 执行Shell命令
      params:
        server: server1
        command: "rm -rf /tmp/test_workspace"
    
    - action: 记录检查项
      params:
        item_name: 测试环境清理完成
        status: success
        details: 临时文件已删除
    
    - action: 生成检查报告
      params:
        report_name: setup_teardown_test
        check_results:
          test_completed: true
          cleanup_done: true